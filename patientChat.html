<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Chat</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css" rel="stylesheet">

<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="keywords" content="Site keywords here">
		<meta name="description" content="">
		<meta name='copyright' content=''>
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<!-- Favicon -->
        <link rel="icon" href="img/fav.png">
		<!-- Google Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Poppins:200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i&display=swap" rel="stylesheet">
		<link rel="stylesheet" href="all.css">
		<!-- Bootstrap CSS -->
		<link rel="stylesheet" href="css/bootstrap.min.css">
		<!-- Nice Select CSS -->
		<link rel="stylesheet" href="css/nice-select.css">
		<!-- Font Awesome CSS -->
        <link rel="stylesheet" href="css/font-awesome.min.css">
		<!-- icofont CSS -->
        <link rel="stylesheet" href="css/icofont.css">
		<!-- Slicknav -->
		<link rel="stylesheet" href="css/slicknav.min.css">
		<!-- Owl Carousel CSS -->
        <link rel="stylesheet" href="css/owl-carousel.css">
		<!-- Datepicker CSS -->
		<link rel="stylesheet" href="css/datepicker.css">
		<!-- Animate CSS -->
        <link rel="stylesheet" href="css/animate.min.css">
		<!-- Magnific Popup CSS -->
        <link rel="stylesheet" href="css/magnific-popup.css">
		<!-- Medipro CSS -->
        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="style.css">
        <link rel="stylesheet" href="css/chat.css">
        <link rel="stylesheet" href="css/responsive.css">	
</head>
<body>
    <header class="header">  
        <div class="topbar">
            <div class="container">
                <div class="row">
                    <div class="col-lg-6 col-md-5 col-12">
                        <ul class="top-link">
                            <li><a href="#">العربيه</a></li>
                            <li><a href="#">About</a></li>
                            <li><a href="#">FAQ?</a></li>
                        </ul>
                    </div>
                    <div class="col-lg-6 col-md-7 col-12">
                        <ul class="top-contact">
                            <li><i class="fa fa-envelope"></i><a href="mailto:support@yourmail.com">SmartPharmacy@gmail.com</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="header-inner">
            <div class="container">
                <div class="inner">
                    <div class="row">
                        <div class="col-lg-3 col-md-3 col-12">
                            <div class="logo">
                                <a href="index.html"><img src="img/logo.png" alt="#"></a>
                            </div>
                            <div class="mobile-nav"></div>
                        </div>
                        <div class="col-lg-7 col-md-9 col-12">
                            <div class="main-menu">
                                <nav class="navigation">
                                    <ul class="nav menu">
                                        <li class="active"><a href="index.html">Home<i class="icofont-rounded-down"></i></a>
                                            <ul class="dropdown">
                                                <li><a href="index.html">Home page</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="AboutUs.html">About us</a></li>
                                        <li><a href="contact.html">Contact</a></li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    
    <div class="container">
        <div class="row clearfix">
            <div class="col-lg-12">
                <div class="card chat-app">
                    <div id="plist" class="people-list">
                        <ul class="list-unstyled chat-list mt-2 mb-0">
                                <li class="clearfix" data-pharmacy="elazaby">
                                <img src="img/e.jpg" alt="avatar">
                                <div class="about">
                                    <div class="name">Elazaby Pharmacy</div>
                                    <div class="status"> <i class="fa fa-circle offline"></i> left 7 mins ago </div>
                                </div>
                            </li>
                            <li class="clearfix active" data-pharmacy="sally">
                                <img src="img/s.jpg" alt="avatar">
                                <div class="about">
                                    <div class="name">Sally Pharmacy</div>
                                    <div class="status"> <i class="fa fa-circle online"></i> online </div>
                                </div>
                            </li>
                            <li class="clearfix" data-pharmacy="eltarshoby">
                                <img src="img/t.jpg" alt="avatar">
                                <div class="about">
                                    <div class="name">Eltarshoby Pharmacy</div>
                                    <div class="status"> <i class="fa fa-circle online"></i> online </div>
                                </div>
                            </li>
                            <li class="clearfix" data-pharmacy="newelzhraa">
                                <img src="img/z.jpg" alt="avatar">
                                <div class="about">
                                    <div class="name">New Elzhraa Pharmacy</div>
                                    <div class="status"> <i class="fa fa-circle offline"></i> left 10 hours ago </div>
                                </div>
                            </li>
                            <li class="clearfix" data-pharmacy="care">
                                <img src="img/ca.jpg" alt="avatar">
                                <div class="about">
                                    <div class="name">Care Pharmacy</div>
                                    <div class="status"> <i class="fa fa-circle online"></i> online </div>
                                </div>
                            </li>
                            <li class="clearfix" data-pharmacy="elhol">
                                <img src="img/h.jpg" alt="avatar">
                                <div class="about">
                                    <div class="name">Elhol Pharmacy</div>
                                    <div class="status"> <i class="fa fa-circle offline"></i> offline since Oct 28 </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <div class="chat">
                        <div class="chat-header clearfix">
                            <div class="row">
                                <div class="col-lg-6">
                                    <a href="javascript:void(0);" data-toggle="modal" data-target="#view_info">
                                        <img src="https://bootdey.com/img/Content/avatar/avatar2.png" alt="avatar" id="pharmacy-avatar">
                                    </a>
                                    <div class="chat-about">
                                        <h6 class="m-b-0" id="pharmacy-name">Sally Pharmacy</h6>
                                        <small id="pharmacy-status">Last seen: 2 hours ago</small>
                                    </div>
                                </div>
                                <div class="col-lg-6 hidden-sm text-right">
                                    <button type="button" class="chatbox-upload-icon btn btn-outline-primary">
                                        <i class='fa fa-image'></i>
                                    </button>
                                    <input type="file" id="imageInput" accept="image/*" style="display: none;">
                                </div>
                            </div>
                        </div>
                        <div class="chat-history">
                            <ul class="m-b-0" id="chat-history">
                            </ul>
                        </div>
                        <div class="chat-message clearfix">
                            <div class="input-group mb-0">
                                <input type="text" id="messageInput" class="form-control" placeholder="Enter text here...">
                                <div class="input-group-append">
                                    <button class="btn btn-primary" id="sendMessage">Send</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script>
        $(document).ready(function() {
            $('.chatbox-upload-icon').on('click', function() {
                $('#imageInput').click();
            });

            $('#imageInput').on('change', function() {
                var file = this.files[0];
                if (file) {
                    var reader = new FileReader();
                    reader.onload = function(e) {
                        var imageUrl = e.target.result;
                        $('#chat-history').append(
                            '<li class="clearfix"><div class="message my-message"><img src="' + imageUrl + '" style="max-width: 200px; max-height: 200px;"></div></li>'
                        );
                    }
                    reader.readAsDataURL(file);
                }
            });

            $('#sendMessage').on('click', function() {
                var message = $('#messageInput').val();
                if (message.trim() !== '') {
                    $('#chat-history').append(
                        '<li class="clearfix"><div class="message my-message">' + message + '</div></li>'
                    );
                    $('.chat-history').scrollTop($('.chat-history')[0].scrollHeight);
                    $('#messageInput').val('');
                }
            });

            // Load Sally Pharmacy chat by default
            const defaultPharmacy = 'sally';
            updateChatHeader(defaultPharmacy);
            loadChat(defaultPharmacy);
        });
    </script>
    <script>
        const chats = {
            elazaby: [
                {time: "10:10 AM, Today", text: "Welcome To Elazaby Pharmacy , Can i help you?", from: "other"},
            ],
            sally: [
                {time: "10:10 AM, Today", text: "Welcome To Sally Pharmacy", from: "other"},
                {time: "10:12 AM, Today", text: "I want to ask about specific medicine?", from: "me"},
            ],
            eltarshoby: [
                {time: "11:00 AM, Today", text: "Hello, Welcome To Eltarshoby Pharmacy", from: "other"},
            ],
            newelzhraa: [
                {time: "09:30 AM, Today", text: "Welcome to New Elzhraa Pharmacy", from: "other"},
            ],
            care: [
                {time: "08:20 AM, Today", text: "Welcome to Care Pharmacy!", from: "other"},
            ],
            elhol: [
                {time: "07:50 AM, Today", text: "Elhol pharmacy , We are open 24/7", from: "other"},
            ]
        };

        function loadChat(pharmacy) {
            const chatHistory = $('#chat-history');
            chatHistory.empty();
            const chatData = chats[pharmacy] || [];
            chatData.forEach(message => {
                if (message.from === 'me' || !message.text.includes('<img')) {
                    const messageClass = message.from === 'me' ? 'my-message' : 'other-message float-right';
                    const messageHtml = `
                        <li class="clearfix">
                            <div class="message-data ${message.from === 'me' ? '' : 'text-right'}">
                                <span class="message-data-time">${message.time}</span>
                            </div>
                            <div class="message ${messageClass}">${message.text}</div>
                        </li>
                    `;
                    chatHistory.append(messageHtml);
                }
            });
            $('.chat-history').scrollTop($('.chat-history')[0].scrollHeight);
        }

        function updateChatHeader(pharmacy) {
            const name = $(`[data-pharmacy=${pharmacy}] .name`).text();
            const status = $(`[data-pharmacy=${pharmacy}] .status`).text();
            const avatar = $(`[data-pharmacy=${pharmacy}] img`).attr('src');
            $('#pharmacy-name').text(name);
            $('#pharmacy-status').text(status);
            $('#pharmacy-avatar').attr('src', avatar);
        }

        $(document).ready(function() {
            $('.chat-list li').on('click', function() {
                $('.chat-list li').removeClass('active');
                $(this).addClass('active');
                const pharmacy = $(this).data('pharmacy');
                updateChatHeader(pharmacy);
                loadChat(pharmacy);
            });

            $('#sendMessage').on('click', function() {
                const pharmacy = $('.chat-list li.active').data('pharmacy');
                const message = $('#messageInput').val();
                if (message.trim() !== '') {
                    const newMessage = {time: new Date().toLocaleTimeString(), text: message, from: 'me'};
                    chats[pharmacy].push(newMessage);
                    loadChat(pharmacy);
                    $('#messageInput').val('');
                }
            });

            $('#imageInput').on('change', function() {
                const pharmacy = $('.chat-list li.active').data('pharmacy');
                const file = this.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const newMessage = {
                            time: new Date().toLocaleTimeString(),
                            text: '<img src="' + e.target.result + '" alt="image" style="max-width: 200px;">',
                            from: 'me'
                        };
                        chats[pharmacy].push(newMessage);
                        loadChat(pharmacy);
                    }
                    reader.readAsDataURL(file);
                }
            });
        });
    </script>

</body>
</html>